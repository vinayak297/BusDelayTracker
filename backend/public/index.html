<!DOCTYPE html>
<html>
<head>
  <title>Bus Delay Tracker</title>
</head>
<body>
  <h1>ğŸšŒ Bus Delay Tracker</h1>

  <p id="status">Loading...</p>
  <p id="crowd"></p>

  <button id="waitBtn" onclick="stillWaiting()">â³ Still Waiting</button>
  <button onclick="busArrived()">âœ… Bus Arrived</button>

  <script>
    const API = "";

    async function loadStatus() {
      const res = await fetch(API + "/bus");
      const data = await res.json();

      document.getElementById("status").innerText =
        `Bus ${data.busNumber} | ETA: ${data.etaMinutes} min | Status: ${data.status}`;

      const crowdRes = await fetch(API + "/crowd");
      const crowd = await crowdRes.json();

      document.getElementById("crowd").innerText =
        `Waiting confirmations: ${crowd.waitingCount} / ${crowd.needed}`;
    }

    async function stillWaiting() {
      const btn = document.getElementById("waitBtn");
      btn.disabled = true;

      await fetch(API + "/still-waiting");
      await loadStatus();

      setTimeout(() => {
        btn.disabled = false;
      }, 5000);
    }

    async function busArrived() {
      await fetch(API + "/bus-arrived");
      loadStatus();
    }

    loadStatus();
  </script>
</body>
</html>

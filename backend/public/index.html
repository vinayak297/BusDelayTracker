<!DOCTYPE html>
<html>
<head>
  <title>Bus Delay Tracker</title>
</head>
<body>
  <h1>üöå Bus Delay Tracker</h1>

  <p id="status">Loading...</p>
  <p id="crowd"></p>

  <button onclick="stillWaiting()">‚è≥ Still Waiting</button>
  <button onclick="busArrived()">‚úÖ Bus Arrived</button>

  <script>
    async function loadStatus() {
      const res = await fetch("/bus");
      const data = await res.json();

      document.getElementById("status").innerText =
        `Bus ${data.busNumber} | ETA: ${data.etaMinutes} min | Status: ${data.status}`;

      document.getElementById("crowd").innerText =
        data.status !== "Arrived"
          ? `Crowd confirmations: ${data.waitingCount} / 3`
          : "";
    }

    async function stillWaiting() {
      await fetch("/still-waiting");
      loadStatus();
    }

    async function busArrived() {
      await fetch("/bus-arrived");
      loadStatus();
    }

    loadStatus();
    setInterval(loadStatus, 5000);
  </script>
</body>
</html>
